{% extends 'schletter_app/base.html' %}
{% load my_tags %}
{% block page_header %}
  <div class="row pb-4">
    <h2>Calendar</h2>
    <div class="pt-1 ml-auto">
        <form class="form-inline" action="{% url 'schletter_app:calendar' %}" method="get">
          <label>Date range: </label>
          <input name="date_min" class="form-control w-25 ml-2" type="text" min="1781-01-21" max="1782-12-31" placeholder="1781-01-21" required>
          <input name="date_max" class="form-control w-25 ml-2" type="text" min="1781-01-21" max="1782-12-31" placeholder="1782-12-31" required>
          <button class="btn btn-primary ml-2" type="submit">Search</button>
          <a class="btn btn-secondary ml-2" href="{% url 'schletter_app:calendar' %}" role="button">Reset</a>
        </form>
    </div>
    <div class="mt-2">
      Click on a row to see the detail view for that event
    </div>
  </div>
        
{% endblock %}
{% block content %}
  <ul>
    {% for date in calendar %}
      <li class="font-weight-bold mt-2 mb-2">{{date}}</li>
      <div class="list-group">
        {% for event in date.event_set.all %}
          {% with event.work_set.all.first as work %}
            {% if event.event_type == "closed" %}
              <li class="list-group-item list-group-item-action">{{event.title}}</li>
            {% else %}
              <a href="{% url 'schletter_app:work' work.pk %}" class="list-group-item list-group-item-action">{{ event.title | display_title:work.genre | safe }}</a>
            {% endif %}
          {% endwith %}
        {% endfor %}
      <div>
    {% empty %}
      <p>No dates match this search</p>
    {% endfor %}
  </ul>
  
{% endblock content %}