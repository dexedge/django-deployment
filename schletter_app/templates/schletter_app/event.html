{% extends 'schletter_app/base.html' %}
{% block page_header %}
  <h3 class="pb-2">Event: {{event.date}}</h3>
{% endblock page_header %}

{% block content %}
  <p>Theater: {{ event.theater }}</p>
  <p>Company: {{ event.company }}</p>
  <p>Title: 
      {% if event.title == "No title" or event.work_set.all.first.genre == "Concert" %}
        <a href="{% url 'schletter_app:work' event.work_set.all.first.pk %}">{{ event.title }}</a>
      {% else %}
        <a href="{% url 'schletter_app:work' event.work_set.all.first.pk %}"><em>{{ event.title }}</em></a>
      {% endif %}
  </p>
  <p>Type: {{ event.event_type }}</p>
  <p>Genre: {{ event.work_set.first.genre }}</p>
  {% if event.work_set.first.authorworks.exists %}
    <p>Author(s): </p>
      <ul>
        {% for aw in event.work_set.first.authorwork_set.all %}
          <li><a href="{% url 'schletter_app:author' aw.author.pk %}">{{ aw.author.last_name }}{% if aw.author.first_names != "NA" %}, {{aw.author.first_names }}{% endif %}</a> ({{aw.role}})</li>
        {% endfor %}
      </ul>
  {% endif %}
    {% if event.work_set.first.composerworks.exists and event.work_set.first.composerworks.first.last_name != "NA" %}
      <p>Composer: <a href="{% url 'schletter_app:composer' event.work_set.first.composerworks.first.pk %}">{{ event.work_set.first.composerworks.first.last_name }}{% if event.work_set.first.composerworks.first.first_names != "NA" %}, {{event.work_set.first.composerworks.first.first_names }}{% endif %}</a></p>
    {% endif %}
  <p>Hadamowsky: {{event.hadamowsky}}</p>
  {% if event.morrow != "NA" %}
    <p>Morrow: {{event.morrow}}</p>
  {% endif %}
  {% if event.notes != "NA" %}
    <p>Notes:</p> 
    <p class="indent">{{ event.notes|safe }}</p>
  {% endif %}
  <hr>
  <div style="font-size:16px"> 
    <p>All events in the theaters on {{event.date}}:</p>
    <ul>
      {% for event in event.date.event_set.all %}
        <li>
            {% if event.event_type == "concert" %}
              <a href="{% url 'schletter_app:event' event.pk %}">
                {{event.title}}</a> ({{event.theater}})
            {% else %}
            {% with work=event.work_set.all.first  %}
              <a href="{% url 'schletter_app:work' work.pk %}">
                  {% if work.title == "No title" %}
                    {{work.title}}
                  {% else %}
                    <em>{{work.title}}</em>
                  {% endif %}</a> ({{event.theater}}, {{work.genre}})
            {% endwith %}
            {% endif %}
        </li>
      {% endfor %}
    </ul>
  </div>
{% endblock content %}